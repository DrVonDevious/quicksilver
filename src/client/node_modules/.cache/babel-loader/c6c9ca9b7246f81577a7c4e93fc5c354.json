{"ast":null,"code":"'use strict';\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nvar __extends = void 0 && (void 0).__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar React = require('react');\n\nvar SERVER_RENDERED = typeof navigator === 'undefined' || global['PREVENT_CODEMIRROR_RENDER'] === true;\nvar cm;\n\nif (!SERVER_RENDERED) {\n  cm = require('codemirror');\n}\n\nvar Helper = function () {\n  function Helper() {}\n\n  Helper.equals = function (x, y) {\n    var _this = this;\n\n    var ok = Object.keys,\n        tx = _typeof(x),\n        ty = _typeof(y);\n\n    return x && y && tx === 'object' && tx === ty ? ok(x).length === ok(y).length && ok(x).every(function (key) {\n      return _this.equals(x[key], y[key]);\n    }) : x === y;\n  };\n\n  return Helper;\n}();\n\nvar Shared = function () {\n  function Shared(editor, props) {\n    this.editor = editor;\n    this.props = props;\n  }\n\n  Shared.prototype.delegateCursor = function (position, scroll, focus) {\n    var doc = this.editor.getDoc();\n\n    if (focus) {\n      this.editor.focus();\n    }\n\n    scroll ? doc.setCursor(position) : doc.setCursor(position, null, {\n      scroll: false\n    });\n  };\n\n  Shared.prototype.delegateScroll = function (coordinates) {\n    this.editor.scrollTo(coordinates.x, coordinates.y);\n  };\n\n  Shared.prototype.delegateSelection = function (ranges, focus) {\n    var doc = this.editor.getDoc();\n    doc.setSelections(ranges);\n\n    if (focus) {\n      this.editor.focus();\n    }\n  };\n\n  Shared.prototype.apply = function (props) {\n    if (props && props.selection && props.selection.ranges) {\n      this.delegateSelection(props.selection.ranges, props.selection.focus || false);\n    }\n\n    if (props && props.cursor) {\n      this.delegateCursor(props.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n\n    if (props && props.scroll) {\n      this.delegateScroll(props.scroll);\n    }\n  };\n\n  Shared.prototype.applyNext = function (props, next, preserved) {\n    if (props && props.selection && props.selection.ranges) {\n      if (next && next.selection && next.selection.ranges && !Helper.equals(props.selection.ranges, next.selection.ranges)) {\n        this.delegateSelection(next.selection.ranges, next.selection.focus || false);\n      }\n    }\n\n    if (props && props.cursor) {\n      if (next && next.cursor && !Helper.equals(props.cursor, next.cursor)) {\n        this.delegateCursor(preserved.cursor || next.cursor, next.autoScroll || false, next.autoCursor || false);\n      }\n    }\n\n    if (props && props.scroll) {\n      if (next && next.scroll && !Helper.equals(props.scroll, next.scroll)) {\n        this.delegateScroll(next.scroll);\n      }\n    }\n  };\n\n  Shared.prototype.applyUserDefined = function (props, preserved) {\n    if (preserved && preserved.cursor) {\n      this.delegateCursor(preserved.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n  };\n\n  Shared.prototype.wire = function (props) {\n    var _this = this;\n\n    Object.keys(props || {}).filter(function (p) {\n      return /^on/.test(p);\n    }).forEach(function (prop) {\n      switch (prop) {\n        case 'onBlur':\n          {\n            _this.editor.on('blur', function (cm, event) {\n              _this.props.onBlur(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onContextMenu':\n          {\n            _this.editor.on('contextmenu', function (cm, event) {\n              _this.props.onContextMenu(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onCopy':\n          {\n            _this.editor.on('copy', function (cm, event) {\n              _this.props.onCopy(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onCursor':\n          {\n            _this.editor.on('cursorActivity', function (cm) {\n              _this.props.onCursor(_this.editor, _this.editor.getDoc().getCursor());\n            });\n          }\n          break;\n\n        case 'onCursorActivity':\n          {\n            _this.editor.on('cursorActivity', function (cm) {\n              _this.props.onCursorActivity(_this.editor);\n            });\n          }\n          break;\n\n        case 'onCut':\n          {\n            _this.editor.on('cut', function (cm, event) {\n              _this.props.onCut(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onDblClick':\n          {\n            _this.editor.on('dblclick', function (cm, event) {\n              _this.props.onDblClick(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onDragEnter':\n          {\n            _this.editor.on('dragenter', function (cm, event) {\n              _this.props.onDragEnter(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onDragLeave':\n          {\n            _this.editor.on('dragleave', function (cm, event) {\n              _this.props.onDragLeave(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onDragOver':\n          {\n            _this.editor.on('dragover', function (cm, event) {\n              _this.props.onDragOver(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onDragStart':\n          {\n            _this.editor.on('dragstart', function (cm, event) {\n              _this.props.onDragStart(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onDrop':\n          {\n            _this.editor.on('drop', function (cm, event) {\n              _this.props.onDrop(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onFocus':\n          {\n            _this.editor.on('focus', function (cm, event) {\n              _this.props.onFocus(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onGutterClick':\n          {\n            _this.editor.on('gutterClick', function (cm, lineNumber, gutter, event) {\n              _this.props.onGutterClick(_this.editor, lineNumber, gutter, event);\n            });\n          }\n          break;\n\n        case 'onInputRead':\n          {\n            _this.editor.on('inputRead', function (cm, EditorChangeEvent) {\n              _this.props.onInputRead(_this.editor, EditorChangeEvent);\n            });\n          }\n          break;\n\n        case 'onKeyDown':\n          {\n            _this.editor.on('keydown', function (cm, event) {\n              _this.props.onKeyDown(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onKeyHandled':\n          {\n            _this.editor.on('keyHandled', function (cm, key, event) {\n              _this.props.onKeyHandled(_this.editor, key, event);\n            });\n          }\n          break;\n\n        case 'onKeyPress':\n          {\n            _this.editor.on('keypress', function (cm, event) {\n              _this.props.onKeyPress(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onKeyUp':\n          {\n            _this.editor.on('keyup', function (cm, event) {\n              _this.props.onKeyUp(_this.editor, event);\n            });\n          }\n          break;\n\n        case 'onMouseDown':\n          {\n            _this.editor.on('mousedown', function (cm, event) {\n              _this.props.onMouseDown(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onPaste':\n          {\n            _this.editor.on('paste', function (cm, event) {\n              _this.props.onPaste(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onRenderLine':\n          {\n            _this.editor.on('renderLine', function (cm, line, element) {\n              _this.props.onRenderLine(_this.editor, line, element);\n            });\n\n            break;\n          }\n\n        case 'onScroll':\n          {\n            _this.editor.on('scroll', function (cm) {\n              _this.props.onScroll(_this.editor, _this.editor.getScrollInfo());\n            });\n          }\n          break;\n\n        case 'onSelection':\n          {\n            _this.editor.on('beforeSelectionChange', function (cm, data) {\n              _this.props.onSelection(_this.editor, data);\n            });\n          }\n          break;\n\n        case 'onTouchStart':\n          {\n            _this.editor.on('touchstart', function (cm, event) {\n              _this.props.onTouchStart(_this.editor, event);\n            });\n\n            break;\n          }\n\n        case 'onUpdate':\n          {\n            _this.editor.on('update', function (cm) {\n              _this.props.onUpdate(_this.editor);\n            });\n          }\n          break;\n\n        case 'onViewportChange':\n          {\n            _this.editor.on('viewportChange', function (cm, from, to) {\n              _this.props.onViewportChange(_this.editor, from, to);\n            });\n          }\n          break;\n      }\n    });\n  };\n\n  return Shared;\n}();\n\nvar Controlled = function (_super) {\n  __extends(Controlled, _super);\n\n  function Controlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedNext = false;\n    _this.appliedUserDefined = false;\n    _this.deferred = null;\n    _this.emulating = false;\n    _this.hydrated = false;\n\n    _this.initCb = function () {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n    return _this;\n  }\n\n  Controlled.prototype.hydrate = function (props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function (key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function (key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n\n            _this.mirror.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      this.deferred ? this.resolveChange() : this.initChange(props.value || '');\n    }\n\n    this.hydrated = true;\n  };\n\n  Controlled.prototype.initChange = function (value) {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n    var lastLine = doc.lastLine();\n    var lastChar = doc.getLine(doc.lastLine()).length;\n    doc.replaceRange(value || '', {\n      line: 0,\n      ch: 0\n    }, {\n      line: lastLine,\n      ch: lastChar\n    });\n    this.mirror.setValue(value);\n    doc.clearHistory();\n    this.mirror.clearHistory();\n    this.emulating = false;\n  };\n\n  Controlled.prototype.resolveChange = function () {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n\n    if (this.deferred.origin === 'undo') {\n      doc.undo();\n    } else if (this.deferred.origin === 'redo') {\n      doc.redo();\n    } else {\n      doc.replaceRange(this.deferred.text, this.deferred.from, this.deferred.to, this.deferred.origin);\n    }\n\n    this.emulating = false;\n    this.deferred = null;\n  };\n\n  Controlled.prototype.mirrorChange = function (deferred) {\n    var doc = this.editor.getDoc();\n\n    if (deferred.origin === 'undo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.undo();\n    } else if (deferred.origin === 'redo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.redo();\n    } else {\n      this.mirror.replaceRange(deferred.text, deferred.from, deferred.to, deferred.origin);\n    }\n\n    return this.mirror.getValue();\n  };\n\n  Controlled.prototype.componentDidMount = function () {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref);\n    this.shared = new Shared(this.editor, this.props);\n    this.mirror = cm(function () {});\n    this.editor.on('electricInput', function () {\n      _this.mirror.setHistory(_this.editor.getDoc().getHistory());\n    });\n    this.editor.on('cursorActivity', function () {\n      _this.mirror.setCursor(_this.editor.getDoc().getCursor());\n    });\n    this.editor.on('beforeChange', function (cm, data) {\n      if (_this.emulating) {\n        return;\n      }\n\n      data.cancel();\n      _this.deferred = data;\n\n      var phantomChange = _this.mirrorChange(_this.deferred);\n\n      if (_this.props.onBeforeChange) _this.props.onBeforeChange(_this.editor, _this.deferred, phantomChange);\n    });\n    this.editor.on('change', function (cm, data) {\n      if (!_this.mounted) {\n        return;\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n\n    if (this.editor.getOption('autofocus')) {\n      this.editor.focus();\n    }\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  Controlled.prototype.componentDidUpdate = function (prevProps) {\n    if (SERVER_RENDERED) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n    }\n\n    if (!this.props.autoCursor && this.props.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.appliedNext) {\n      this.shared.applyNext(prevProps, this.props, preserved);\n      this.appliedNext = true;\n    }\n\n    this.shared.applyUserDefined(prevProps, preserved);\n    this.appliedUserDefined = true;\n  };\n\n  Controlled.prototype.componentWillUnmount = function () {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  Controlled.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n    return !SERVER_RENDERED;\n  };\n\n  Controlled.prototype.render = function () {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return Controlled;\n}(React.Component);\n\nexports.Controlled = Controlled;\n\nvar UnControlled = function (_super) {\n  __extends(UnControlled, _super);\n\n  function UnControlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedUserDefined = false;\n    _this.continueChange = false;\n    _this.detached = false;\n    _this.hydrated = false;\n\n    _this.initCb = function () {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n\n    _this.onBeforeChangeCb = function () {\n      _this.continueChange = true;\n    };\n\n    return _this;\n  }\n\n  UnControlled.prototype.hydrate = function (props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function (key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function (key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      var doc = this.editor.getDoc();\n      var lastLine = doc.lastLine();\n      var lastChar = doc.getLine(doc.lastLine()).length;\n      doc.replaceRange(props.value || '', {\n        line: 0,\n        ch: 0\n      }, {\n        line: lastLine,\n        ch: lastChar\n      });\n    }\n\n    this.hydrated = true;\n  };\n\n  UnControlled.prototype.componentDidMount = function () {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n    this.detached = this.props.detach === true;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref);\n    this.shared = new Shared(this.editor, this.props);\n    this.editor.on('beforeChange', function (cm, data) {\n      if (_this.props.onBeforeChange) {\n        _this.props.onBeforeChange(_this.editor, data, _this.editor.getValue(), _this.onBeforeChangeCb);\n      }\n    });\n    this.editor.on('change', function (cm, data) {\n      if (!_this.mounted || !_this.props.onChange) {\n        return;\n      }\n\n      if (_this.props.onBeforeChange) {\n        if (_this.continueChange) {\n          _this.props.onChange(_this.editor, data, _this.editor.getValue());\n        }\n      } else {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n    this.editor.getDoc().clearHistory();\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  UnControlled.prototype.componentDidUpdate = function (prevProps) {\n    if (this.detached && this.props.detach === false) {\n      this.detached = false;\n\n      if (prevProps.editorDidAttach) {\n        prevProps.editorDidAttach(this.editor);\n      }\n    }\n\n    if (!this.detached && this.props.detach === true) {\n      this.detached = true;\n\n      if (prevProps.editorDidDetach) {\n        prevProps.editorDidDetach(this.editor);\n      }\n    }\n\n    if (SERVER_RENDERED || this.detached) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n      this.applied = false;\n      this.appliedUserDefined = false;\n    }\n\n    if (!prevProps.autoCursor && prevProps.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.applied) {\n      this.shared.apply(prevProps);\n      this.applied = true;\n    }\n\n    if (!this.appliedUserDefined) {\n      this.shared.applyUserDefined(prevProps, preserved);\n      this.appliedUserDefined = true;\n    }\n  };\n\n  UnControlled.prototype.componentWillUnmount = function () {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  UnControlled.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n    var update = true;\n    if (SERVER_RENDERED) update = false;\n    if (this.detached && nextProps.detach) update = false;\n    return update;\n  };\n\n  UnControlled.prototype.render = function () {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return UnControlled;\n}(React.Component);\n\nexports.UnControlled = UnControlled;","map":{"version":3,"sources":["/Users/william/Dev/quicksilver/node_modules/react-codemirror2/index.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","_typeof","obj","Symbol","iterator","constructor","__extends","_extendStatics","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","__","create","defineProperty","exports","value","React","require","SERVER_RENDERED","navigator","global","cm","Helper","equals","x","y","_this","ok","keys","tx","ty","every","Shared","editor","props","delegateCursor","position","scroll","focus","doc","getDoc","setCursor","delegateScroll","coordinates","scrollTo","delegateSelection","ranges","setSelections","selection","cursor","autoScroll","getOption","applyNext","next","preserved","autoCursor","applyUserDefined","wire","filter","test","forEach","prop","on","event","onBlur","onContextMenu","onCopy","onCursor","getCursor","onCursorActivity","onCut","onDblClick","onDragEnter","onDragLeave","onDragOver","onDragStart","onDrop","onFocus","lineNumber","gutter","onGutterClick","EditorChangeEvent","onInputRead","onKeyDown","onKeyHandled","onKeyPress","onKeyUp","onMouseDown","onPaste","line","element","onRenderLine","onScroll","getScrollInfo","data","onSelection","onTouchStart","onUpdate","from","to","onViewportChange","Controlled","_super","applied","appliedNext","appliedUserDefined","deferred","emulating","hydrated","initCb","editorDidConfigure","mounted","hydrate","_options","options","userDefinedOptions","defaults","optionDelta","some","setOption","mirror","resolveChange","initChange","lastLine","lastChar","getLine","replaceRange","ch","setValue","clearHistory","origin","undo","redo","text","mirrorChange","setHistory","getHistory","getValue","componentDidMount","defineMode","name","fn","ref","shared","cancel","phantomChange","onBeforeChange","onChange","editorDidMount","componentDidUpdate","prevProps","undefined","componentWillUnmount","editorWillUnmount","shouldComponentUpdate","nextProps","nextState","render","className","createElement","self","Component","UnControlled","continueChange","detached","onBeforeChangeCb","detach","editorDidAttach","editorDidDetach","update"],"mappings":"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","sourcesContent":["'use strict';\n\nfunction _extends() {\n  _extends = Object.assign || function(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\n\nvar __extends = void 0 && (void 0).__extends || function() {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    }\n    instanceof Array && function(d, b) {\n      d.__proto__ = b;\n    } || function(d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function(d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar React = require('react');\n\nvar SERVER_RENDERED = typeof navigator === 'undefined' || global['PREVENT_CODEMIRROR_RENDER'] === true;\nvar cm;\n\nif (!SERVER_RENDERED) {\n  cm = require('codemirror');\n}\n\nvar Helper = function() {\n  function Helper() {}\n\n  Helper.equals = function(x, y) {\n    var _this = this;\n\n    var ok = Object.keys,\n      tx = _typeof(x),\n      ty = _typeof(y);\n\n    return x && y && tx === 'object' && tx === ty ? ok(x).length === ok(y).length && ok(x).every(function(key) {\n      return _this.equals(x[key], y[key]);\n    }) : x === y;\n  };\n\n  return Helper;\n}();\n\nvar Shared = function() {\n  function Shared(editor, props) {\n    this.editor = editor;\n    this.props = props;\n  }\n\n  Shared.prototype.delegateCursor = function(position, scroll, focus) {\n    var doc = this.editor.getDoc();\n\n    if (focus) {\n      this.editor.focus();\n    }\n\n    scroll ? doc.setCursor(position) : doc.setCursor(position, null, {\n      scroll: false\n    });\n  };\n\n  Shared.prototype.delegateScroll = function(coordinates) {\n    this.editor.scrollTo(coordinates.x, coordinates.y);\n  };\n\n  Shared.prototype.delegateSelection = function(ranges, focus) {\n    var doc = this.editor.getDoc();\n    doc.setSelections(ranges);\n\n    if (focus) {\n      this.editor.focus();\n    }\n  };\n\n  Shared.prototype.apply = function(props) {\n    if (props && props.selection && props.selection.ranges) {\n      this.delegateSelection(props.selection.ranges, props.selection.focus || false);\n    }\n\n    if (props && props.cursor) {\n      this.delegateCursor(props.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n\n    if (props && props.scroll) {\n      this.delegateScroll(props.scroll);\n    }\n  };\n\n  Shared.prototype.applyNext = function(props, next, preserved) {\n    if (props && props.selection && props.selection.ranges) {\n      if (next && next.selection && next.selection.ranges && !Helper.equals(props.selection.ranges, next.selection.ranges)) {\n        this.delegateSelection(next.selection.ranges, next.selection.focus || false);\n      }\n    }\n\n    if (props && props.cursor) {\n      if (next && next.cursor && !Helper.equals(props.cursor, next.cursor)) {\n        this.delegateCursor(preserved.cursor || next.cursor, next.autoScroll || false, next.autoCursor || false);\n      }\n    }\n\n    if (props && props.scroll) {\n      if (next && next.scroll && !Helper.equals(props.scroll, next.scroll)) {\n        this.delegateScroll(next.scroll);\n      }\n    }\n  };\n\n  Shared.prototype.applyUserDefined = function(props, preserved) {\n    if (preserved && preserved.cursor) {\n      this.delegateCursor(preserved.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n  };\n\n  Shared.prototype.wire = function(props) {\n    var _this = this;\n\n    Object.keys(props || {}).filter(function(p) {\n      return /^on/.test(p);\n    }).forEach(function(prop) {\n      switch (prop) {\n        case 'onBlur': {\n          _this.editor.on('blur', function(cm, event) {\n            _this.props.onBlur(_this.editor, event);\n          });\n        }\n        break;\n\n      case 'onContextMenu': {\n        _this.editor.on('contextmenu', function(cm, event) {\n          _this.props.onContextMenu(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onCopy': {\n        _this.editor.on('copy', function(cm, event) {\n          _this.props.onCopy(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onCursor': {\n        _this.editor.on('cursorActivity', function(cm) {\n          _this.props.onCursor(_this.editor, _this.editor.getDoc().getCursor());\n        });\n      }\n      break;\n\n      case 'onCursorActivity': {\n        _this.editor.on('cursorActivity', function(cm) {\n          _this.props.onCursorActivity(_this.editor);\n        });\n      }\n      break;\n\n      case 'onCut': {\n        _this.editor.on('cut', function(cm, event) {\n          _this.props.onCut(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDblClick': {\n        _this.editor.on('dblclick', function(cm, event) {\n          _this.props.onDblClick(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDragEnter': {\n        _this.editor.on('dragenter', function(cm, event) {\n          _this.props.onDragEnter(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onDragLeave': {\n        _this.editor.on('dragleave', function(cm, event) {\n          _this.props.onDragLeave(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDragOver': {\n        _this.editor.on('dragover', function(cm, event) {\n          _this.props.onDragOver(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onDragStart': {\n        _this.editor.on('dragstart', function(cm, event) {\n          _this.props.onDragStart(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDrop': {\n        _this.editor.on('drop', function(cm, event) {\n          _this.props.onDrop(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onFocus': {\n        _this.editor.on('focus', function(cm, event) {\n          _this.props.onFocus(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onGutterClick': {\n        _this.editor.on('gutterClick', function(cm, lineNumber, gutter, event) {\n          _this.props.onGutterClick(_this.editor, lineNumber, gutter, event);\n        });\n      }\n      break;\n\n      case 'onInputRead': {\n        _this.editor.on('inputRead', function(cm, EditorChangeEvent) {\n          _this.props.onInputRead(_this.editor, EditorChangeEvent);\n        });\n      }\n      break;\n\n      case 'onKeyDown': {\n        _this.editor.on('keydown', function(cm, event) {\n          _this.props.onKeyDown(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onKeyHandled': {\n        _this.editor.on('keyHandled', function(cm, key, event) {\n          _this.props.onKeyHandled(_this.editor, key, event);\n        });\n      }\n      break;\n\n      case 'onKeyPress': {\n        _this.editor.on('keypress', function(cm, event) {\n          _this.props.onKeyPress(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onKeyUp': {\n        _this.editor.on('keyup', function(cm, event) {\n          _this.props.onKeyUp(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onMouseDown': {\n        _this.editor.on('mousedown', function(cm, event) {\n          _this.props.onMouseDown(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onPaste': {\n        _this.editor.on('paste', function(cm, event) {\n          _this.props.onPaste(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onRenderLine': {\n        _this.editor.on('renderLine', function(cm, line, element) {\n          _this.props.onRenderLine(_this.editor, line, element);\n        });\n\n        break;\n      }\n\n      case 'onScroll': {\n        _this.editor.on('scroll', function(cm) {\n          _this.props.onScroll(_this.editor, _this.editor.getScrollInfo());\n        });\n      }\n      break;\n\n      case 'onSelection': {\n        _this.editor.on('beforeSelectionChange', function(cm, data) {\n          _this.props.onSelection(_this.editor, data);\n        });\n      }\n      break;\n\n      case 'onTouchStart': {\n        _this.editor.on('touchstart', function(cm, event) {\n          _this.props.onTouchStart(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onUpdate': {\n        _this.editor.on('update', function(cm) {\n          _this.props.onUpdate(_this.editor);\n        });\n      }\n      break;\n\n      case 'onViewportChange': {\n        _this.editor.on('viewportChange', function(cm, from, to) {\n          _this.props.onViewportChange(_this.editor, from, to);\n        });\n      }\n      break;\n      }\n    });\n  };\n\n  return Shared;\n}();\n\nvar Controlled = function(_super) {\n  __extends(Controlled, _super);\n\n  function Controlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedNext = false;\n    _this.appliedUserDefined = false;\n    _this.deferred = null;\n    _this.emulating = false;\n    _this.hydrated = false;\n\n    _this.initCb = function() {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n    return _this;\n  }\n\n  Controlled.prototype.hydrate = function(props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function(key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function(key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n\n            _this.mirror.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      this.deferred ? this.resolveChange() : this.initChange(props.value || '');\n    }\n\n    this.hydrated = true;\n  };\n\n  Controlled.prototype.initChange = function(value) {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n    var lastLine = doc.lastLine();\n    var lastChar = doc.getLine(doc.lastLine()).length;\n    doc.replaceRange(value || '', {\n      line: 0,\n      ch: 0\n    }, {\n      line: lastLine,\n      ch: lastChar\n    });\n    this.mirror.setValue(value);\n    doc.clearHistory();\n    this.mirror.clearHistory();\n    this.emulating = false;\n  };\n\n  Controlled.prototype.resolveChange = function() {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n\n    if (this.deferred.origin === 'undo') {\n      doc.undo();\n    } else if (this.deferred.origin === 'redo') {\n      doc.redo();\n    } else {\n      doc.replaceRange(this.deferred.text, this.deferred.from, this.deferred.to, this.deferred.origin);\n    }\n\n    this.emulating = false;\n    this.deferred = null;\n  };\n\n  Controlled.prototype.mirrorChange = function(deferred) {\n    var doc = this.editor.getDoc();\n\n    if (deferred.origin === 'undo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.undo();\n    } else if (deferred.origin === 'redo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.redo();\n    } else {\n      this.mirror.replaceRange(deferred.text, deferred.from, deferred.to, deferred.origin);\n    }\n\n    return this.mirror.getValue();\n  };\n\n  Controlled.prototype.componentDidMount = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref);\n    this.shared = new Shared(this.editor, this.props);\n    this.mirror = cm(function() {});\n    this.editor.on('electricInput', function() {\n      _this.mirror.setHistory(_this.editor.getDoc().getHistory());\n    });\n    this.editor.on('cursorActivity', function() {\n      _this.mirror.setCursor(_this.editor.getDoc().getCursor());\n    });\n    this.editor.on('beforeChange', function(cm, data) {\n      if (_this.emulating) {\n        return;\n      }\n\n      data.cancel();\n      _this.deferred = data;\n\n      var phantomChange = _this.mirrorChange(_this.deferred);\n\n      if (_this.props.onBeforeChange) _this.props.onBeforeChange(_this.editor, _this.deferred, phantomChange);\n    });\n    this.editor.on('change', function(cm, data) {\n      if (!_this.mounted) {\n        return;\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n\n    if (this.editor.getOption('autofocus')) {\n      this.editor.focus();\n    }\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  Controlled.prototype.componentDidUpdate = function(prevProps) {\n    if (SERVER_RENDERED) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n    }\n\n    if (!this.props.autoCursor && this.props.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.appliedNext) {\n      this.shared.applyNext(prevProps, this.props, preserved);\n      this.appliedNext = true;\n    }\n\n    this.shared.applyUserDefined(prevProps, preserved);\n    this.appliedUserDefined = true;\n  };\n\n  Controlled.prototype.componentWillUnmount = function() {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  Controlled.prototype.shouldComponentUpdate = function(nextProps, nextState) {\n    return !SERVER_RENDERED;\n  };\n\n  Controlled.prototype.render = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return Controlled;\n}(React.Component);\n\nexports.Controlled = Controlled;\n\nvar UnControlled = function(_super) {\n  __extends(UnControlled, _super);\n\n  function UnControlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedUserDefined = false;\n    _this.continueChange = false;\n    _this.detached = false;\n    _this.hydrated = false;\n\n    _this.initCb = function() {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n\n    _this.onBeforeChangeCb = function() {\n      _this.continueChange = true;\n    };\n\n    return _this;\n  }\n\n  UnControlled.prototype.hydrate = function(props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function(key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function(key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      var doc = this.editor.getDoc();\n      var lastLine = doc.lastLine();\n      var lastChar = doc.getLine(doc.lastLine()).length;\n      doc.replaceRange(props.value || '', {\n        line: 0,\n        ch: 0\n      }, {\n        line: lastLine,\n        ch: lastChar\n      });\n    }\n\n    this.hydrated = true;\n  };\n\n  UnControlled.prototype.componentDidMount = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n    this.detached = this.props.detach === true;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref);\n    this.shared = new Shared(this.editor, this.props);\n    this.editor.on('beforeChange', function(cm, data) {\n      if (_this.props.onBeforeChange) {\n        _this.props.onBeforeChange(_this.editor, data, _this.editor.getValue(), _this.onBeforeChangeCb);\n      }\n    });\n    this.editor.on('change', function(cm, data) {\n      if (!_this.mounted || !_this.props.onChange) {\n        return;\n      }\n\n      if (_this.props.onBeforeChange) {\n        if (_this.continueChange) {\n          _this.props.onChange(_this.editor, data, _this.editor.getValue());\n        }\n      } else {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n    this.editor.getDoc().clearHistory();\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  UnControlled.prototype.componentDidUpdate = function(prevProps) {\n    if (this.detached && this.props.detach === false) {\n      this.detached = false;\n\n      if (prevProps.editorDidAttach) {\n        prevProps.editorDidAttach(this.editor);\n      }\n    }\n\n    if (!this.detached && this.props.detach === true) {\n      this.detached = true;\n\n      if (prevProps.editorDidDetach) {\n        prevProps.editorDidDetach(this.editor);\n      }\n    }\n\n    if (SERVER_RENDERED || this.detached) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n      this.applied = false;\n      this.appliedUserDefined = false;\n    }\n\n    if (!prevProps.autoCursor && prevProps.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.applied) {\n      this.shared.apply(prevProps);\n      this.applied = true;\n    }\n\n    if (!this.appliedUserDefined) {\n      this.shared.applyUserDefined(prevProps, preserved);\n      this.appliedUserDefined = true;\n    }\n  };\n\n  UnControlled.prototype.componentWillUnmount = function() {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  UnControlled.prototype.shouldComponentUpdate = function(nextProps, nextState) {\n    var update = true;\n    if (SERVER_RENDERED) update = false;\n    if (this.detached && nextProps.detach) update = false;\n    return update;\n  };\n\n  UnControlled.prototype.render = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return UnControlled;\n}(React.Component);\n\nexports.UnControlled = UnControlled;"]},"metadata":{},"sourceType":"script"}