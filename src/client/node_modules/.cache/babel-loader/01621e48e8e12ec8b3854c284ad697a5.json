{"ast":null,"code":"/*\n\tpseudo selectors\n\t\n\t---\n\t\n\tthey are available in two forms:\n\t* filters called when the selector \n\t  is compiled and return a function\n\t  that needs to return next()\n\t* pseudos get called on execution\n\t  they need to return a boolean\n*/\nvar DomUtils = require(\"domutils\"),\n    isTag = DomUtils.isTag,\n    getText = DomUtils.getText,\n    getParent = DomUtils.getParent,\n    getChildren = DomUtils.getChildren,\n    getSiblings = DomUtils.getSiblings,\n    hasAttrib = DomUtils.hasAttrib,\n    getName = DomUtils.getName,\n    getAttribute = DomUtils.getAttributeValue,\n    getNCheck = require(\"nth-check\"),\n    checkAttrib = require(\"./attributes.js\").rules.equals,\n    BaseFuncs = require(\"boolbase\"),\n    trueFunc = BaseFuncs.trueFunc,\n    falseFunc = BaseFuncs.falseFunc; //helper methods\n\n\nfunction getFirstElement(elems) {\n  for (var i = 0; elems && i < elems.length; i++) {\n    if (isTag(elems[i])) return elems[i];\n  }\n}\n\nfunction getAttribFunc(name, value) {\n  var data = {\n    name: name,\n    value: value\n  };\n  return function attribFunc(next) {\n    return checkAttrib(next, data);\n  };\n}\n\nfunction getChildFunc(next) {\n  return function (elem) {\n    return !!getParent(elem) && next(elem);\n  };\n}\n\nvar filters = {\n  contains: function (next, text) {\n    if ((text.charAt(0) === \"\\\"\" || text.charAt(0) === \"'\") && text.charAt(0) === text.substr(-1)) {\n      text = text.slice(1, -1);\n    }\n\n    return function contains(elem) {\n      return next(elem) && getText(elem).indexOf(text) >= 0;\n    };\n  },\n  //location specific methods\n  \"nth-child\": function (next, rule) {\n    var func = getNCheck(rule);\n    if (func === falseFunc) return func;\n    if (func === trueFunc) return getChildFunc(next);\n    return function nthChild(elem) {\n      var siblings = getSiblings(elem);\n\n      for (var i = 0, pos = 0; i < siblings.length; i++) {\n        if (isTag(siblings[i])) {\n          if (siblings[i] === elem) break;else pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  \"nth-last-child\": function (next, rule) {\n    var func = getNCheck(rule);\n    if (func === falseFunc) return func;\n    if (func === trueFunc) return getChildFunc(next);\n    return function nthLastChild(elem) {\n      var siblings = getSiblings(elem);\n\n      for (var pos = 0, i = siblings.length - 1; i >= 0; i--) {\n        if (isTag(siblings[i])) {\n          if (siblings[i] === elem) break;else pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  \"nth-of-type\": function (next, rule) {\n    var func = getNCheck(rule);\n    if (func === falseFunc) return func;\n    if (func === trueFunc) return getChildFunc(next);\n    return function nthOfType(elem) {\n      var siblings = getSiblings(elem);\n\n      for (var pos = 0, i = 0; i < siblings.length; i++) {\n        if (isTag(siblings[i])) {\n          if (siblings[i] === elem) break;\n          if (getName(siblings[i]) === getName(elem)) pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  \"nth-last-of-type\": function (next, rule) {\n    var func = getNCheck(rule);\n    if (func === falseFunc) return func;\n    if (func === trueFunc) return getChildFunc(next);\n    return function nthLastOfType(elem) {\n      var siblings = getSiblings(elem);\n\n      for (var pos = 0, i = siblings.length - 1; i >= 0; i--) {\n        if (isTag(siblings[i])) {\n          if (siblings[i] === elem) break;\n          if (getName(siblings[i]) === getName(elem)) pos++;\n        }\n      }\n\n      return func(pos) && next(elem);\n    };\n  },\n  //jQuery extensions (others follow as pseudos)\n  checkbox: getAttribFunc(\"type\", \"checkbox\"),\n  file: getAttribFunc(\"type\", \"file\"),\n  password: getAttribFunc(\"type\", \"password\"),\n  radio: getAttribFunc(\"type\", \"radio\"),\n  reset: getAttribFunc(\"type\", \"reset\"),\n  image: getAttribFunc(\"type\", \"image\"),\n  submit: getAttribFunc(\"type\", \"submit\")\n}; //while filters are precompiled, pseudos get called when they are needed\n\nvar pseudos = {\n  root: function (elem) {\n    return !getParent(elem);\n  },\n  empty: function (elem) {\n    return !getChildren(elem).some(function (elem) {\n      return isTag(elem) || elem.type === \"text\";\n    });\n  },\n  \"first-child\": function (elem) {\n    return getFirstElement(getSiblings(elem)) === elem;\n  },\n  \"last-child\": function (elem) {\n    var siblings = getSiblings(elem);\n\n    for (var i = siblings.length - 1; i >= 0; i--) {\n      if (siblings[i] === elem) return true;\n      if (isTag(siblings[i])) break;\n    }\n\n    return false;\n  },\n  \"first-of-type\": function (elem) {\n    var siblings = getSiblings(elem);\n\n    for (var i = 0; i < siblings.length; i++) {\n      if (isTag(siblings[i])) {\n        if (siblings[i] === elem) return true;\n        if (getName(siblings[i]) === getName(elem)) break;\n      }\n    }\n\n    return false;\n  },\n  \"last-of-type\": function (elem) {\n    var siblings = getSiblings(elem);\n\n    for (var i = siblings.length - 1; i >= 0; i--) {\n      if (isTag(siblings[i])) {\n        if (siblings[i] === elem) return true;\n        if (getName(siblings[i]) === getName(elem)) break;\n      }\n    }\n\n    return false;\n  },\n  \"only-of-type\": function (elem) {\n    var siblings = getSiblings(elem);\n\n    for (var i = 0, j = siblings.length; i < j; i++) {\n      if (isTag(siblings[i])) {\n        if (siblings[i] === elem) continue;\n        if (getName(siblings[i]) === getName(elem)) return false;\n      }\n    }\n\n    return true;\n  },\n  \"only-child\": function (elem) {\n    var siblings = getSiblings(elem);\n\n    for (var i = 0; i < siblings.length; i++) {\n      if (isTag(siblings[i]) && siblings[i] !== elem) return false;\n    }\n\n    return true;\n  },\n  //forms\n  //to consider: :target, :enabled\n  selected: function (elem) {\n    if (hasAttrib(elem, \"selected\")) return true;else if (getName(elem) !== \"option\") return false; //the first <option> in a <select> is also selected\n\n    var parent = getParent(elem);\n    if (!parent || getName(parent) !== \"select\" || hasAttrib(parent, \"multiple\")) return false;\n    var siblings = getChildren(parent),\n        sawElem = false;\n\n    for (var i = 0; i < siblings.length; i++) {\n      if (isTag(siblings[i])) {\n        if (siblings[i] === elem) {\n          sawElem = true;\n        } else if (!sawElem) {\n          return false;\n        } else if (hasAttrib(siblings[i], \"selected\")) {\n          return false;\n        }\n      }\n    }\n\n    return sawElem;\n  },\n  disabled: function (elem) {\n    return hasAttrib(elem, \"disabled\");\n  },\n  enabled: function (elem) {\n    return !hasAttrib(elem, \"disabled\");\n  },\n  checked: function (elem) {\n    return hasAttrib(elem, \"checked\") || pseudos.selected(elem);\n  },\n  //jQuery extensions\n  //:parent is the inverse of :empty\n  parent: function (elem) {\n    return !pseudos.empty(elem);\n  },\n  header: function (elem) {\n    var name = getName(elem);\n    return name === \"h1\" || name === \"h2\" || name === \"h3\" || name === \"h4\" || name === \"h5\" || name === \"h6\";\n  },\n  button: function (elem) {\n    var name = getName(elem);\n    return name === \"button\" || name === \"input\" && getAttribute(elem, \"type\") === \"button\";\n  },\n  input: function (elem) {\n    var name = getName(elem);\n    return name === \"input\" || name === \"textarea\" || name === \"select\" || name === \"button\";\n  },\n  text: function (elem) {\n    var attr;\n    return getName(elem) === \"input\" && (!(attr = getAttribute(elem, \"type\")) || attr.toLowerCase() === \"text\");\n  }\n};\n\nfunction verifyArgs(func, name, subselect) {\n  if (subselect === null) {\n    if (func.length > 1) {\n      throw new SyntaxError(\"pseudo-selector :\" + name + \" requires an argument\");\n    }\n  } else {\n    if (func.length === 1) {\n      throw new SyntaxError(\"pseudo-selector :\" + name + \" doesn't have any arguments\");\n    }\n  }\n} //TODO this feels hacky\n\n\nvar re_CSS3 = /^(?:(?:nth|last|first|only)-(?:child|of-type)|root|empty|(?:en|dis)abled|checked|not)$/;\nmodule.exports = {\n  compile: function (next, data, options) {\n    var name = data.name,\n        subselect = data.data;\n\n    if (options && options.strict && !re_CSS3.test(name)) {\n      throw SyntaxError(\":\" + name + \" isn't part of CSS3\");\n    }\n\n    if (typeof filters[name] === \"function\") {\n      verifyArgs(filters[name], name, subselect);\n      return filters[name](next, subselect, options);\n    } else if (typeof pseudos[name] === \"function\") {\n      var func = pseudos[name];\n      verifyArgs(func, name, subselect);\n      if (next === trueFunc) return func;\n      return function pseudoArgs(elem) {\n        return func(elem, subselect) && next(elem);\n      };\n    } else {\n      throw new SyntaxError(\"unmatched pseudo-class :\" + name);\n    }\n  },\n  filters: filters,\n  pseudos: pseudos\n};","map":{"version":3,"sources":["/Users/william/Dev/quicksilver/node_modules/cheerio/node_modules/css-select/lib/pseudos.js"],"names":["DomUtils","require","isTag","getText","getParent","getChildren","getSiblings","hasAttrib","getName","getAttribute","getAttributeValue","getNCheck","checkAttrib","rules","equals","BaseFuncs","trueFunc","falseFunc","getFirstElement","elems","i","length","getAttribFunc","name","value","data","attribFunc","next","getChildFunc","elem","filters","contains","text","charAt","substr","slice","indexOf","rule","func","nthChild","siblings","pos","nthLastChild","nthOfType","nthLastOfType","checkbox","file","password","radio","reset","image","submit","pseudos","root","empty","some","type","j","selected","parent","sawElem","disabled","enabled","checked","header","button","input","attr","toLowerCase","verifyArgs","subselect","SyntaxError","re_CSS3","module","exports","compile","options","strict","test","pseudoArgs"],"mappings":"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","sourcesContent":["/*\n\tpseudo selectors\n\t\n\t---\n\t\n\tthey are available in two forms:\n\t* filters called when the selector \n\t  is compiled and return a function\n\t  that needs to return next()\n\t* pseudos get called on execution\n\t  they need to return a boolean\n*/\n\nvar DomUtils    = require(\"domutils\"),\n    isTag       = DomUtils.isTag,\n    getText     = DomUtils.getText,\n    getParent   = DomUtils.getParent,\n    getChildren = DomUtils.getChildren,\n    getSiblings = DomUtils.getSiblings,\n    hasAttrib   = DomUtils.hasAttrib,\n    getName     = DomUtils.getName,\n    getAttribute= DomUtils.getAttributeValue,\n    getNCheck   = require(\"nth-check\"),\n    checkAttrib = require(\"./attributes.js\").rules.equals,\n    BaseFuncs   = require(\"boolbase\"),\n    trueFunc    = BaseFuncs.trueFunc,\n    falseFunc   = BaseFuncs.falseFunc;\n\n//helper methods\nfunction getFirstElement(elems){\n\tfor(var i = 0; elems && i < elems.length; i++){\n\t\tif(isTag(elems[i])) return elems[i];\n\t}\n}\n\nfunction getAttribFunc(name, value){\n\tvar data = {name: name, value: value};\n\treturn function attribFunc(next){\n\t\treturn checkAttrib(next, data);\n\t};\n}\n\nfunction getChildFunc(next){\n\treturn function(elem){\n\t\treturn !!getParent(elem) && next(elem);\n\t};\n}\n\nvar filters = {\n\tcontains: function(next, text){\n\t\tif(\n\t\t\t(text.charAt(0) === \"\\\"\" || text.charAt(0) === \"'\") &&\n\t\t\ttext.charAt(0) === text.substr(-1)\n\t\t){\n\t\t\ttext = text.slice(1, -1);\n\t\t}\n\t\treturn function contains(elem){\n\t\t\treturn next(elem) && getText(elem).indexOf(text) >= 0;\n\t\t};\n\t},\n\n\t//location specific methods\n\t\"nth-child\": function(next, rule){\n\t\tvar func = getNCheck(rule);\n\n\t\tif(func === falseFunc) return func;\n\t\tif(func === trueFunc)  return getChildFunc(next);\n\n\t\treturn function nthChild(elem){\n\t\t\tvar siblings = getSiblings(elem);\n\n\t\t\tfor(var i = 0, pos = 0; i < siblings.length; i++){\n\t\t\t\tif(isTag(siblings[i])){\n\t\t\t\t\tif(siblings[i] === elem) break;\n\t\t\t\t\telse pos++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn func(pos) && next(elem);\n\t\t};\n\t},\n\t\"nth-last-child\": function(next, rule){\n\t\tvar func = getNCheck(rule);\n\n\t\tif(func === falseFunc) return func;\n\t\tif(func === trueFunc)  return getChildFunc(next);\n\n\t\treturn function nthLastChild(elem){\n\t\t\tvar siblings = getSiblings(elem);\n\n\t\t\tfor(var pos = 0, i = siblings.length - 1; i >= 0; i--){\n\t\t\t\tif(isTag(siblings[i])){\n\t\t\t\t\tif(siblings[i] === elem) break;\n\t\t\t\t\telse pos++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn func(pos) && next(elem);\n\t\t};\n\t},\n\t\"nth-of-type\": function(next, rule){\n\t\tvar func = getNCheck(rule);\n\n\t\tif(func === falseFunc) return func;\n\t\tif(func === trueFunc)  return getChildFunc(next);\n\n\t\treturn function nthOfType(elem){\n\t\t\tvar siblings = getSiblings(elem);\n\n\t\t\tfor(var pos = 0, i = 0; i < siblings.length; i++){\n\t\t\t\tif(isTag(siblings[i])){\n\t\t\t\t\tif(siblings[i] === elem) break;\n\t\t\t\t\tif(getName(siblings[i]) === getName(elem)) pos++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn func(pos) && next(elem);\n\t\t};\n\t},\n\t\"nth-last-of-type\": function(next, rule){\n\t\tvar func = getNCheck(rule);\n\n\t\tif(func === falseFunc) return func;\n\t\tif(func === trueFunc)  return getChildFunc(next);\n\n\t\treturn function nthLastOfType(elem){\n\t\t\tvar siblings = getSiblings(elem);\n\n\t\t\tfor(var pos = 0, i = siblings.length - 1; i >= 0; i--){\n\t\t\t\tif(isTag(siblings[i])){\n\t\t\t\t\tif(siblings[i] === elem) break;\n\t\t\t\t\tif(getName(siblings[i]) === getName(elem)) pos++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn func(pos) && next(elem);\n\t\t};\n\t},\n\n\t//jQuery extensions (others follow as pseudos)\n\tcheckbox: getAttribFunc(\"type\", \"checkbox\"),\n\tfile: getAttribFunc(\"type\", \"file\"),\n\tpassword: getAttribFunc(\"type\", \"password\"),\n\tradio: getAttribFunc(\"type\", \"radio\"),\n\treset: getAttribFunc(\"type\", \"reset\"),\n\timage: getAttribFunc(\"type\", \"image\"),\n\tsubmit: getAttribFunc(\"type\", \"submit\")\n};\n\n//while filters are precompiled, pseudos get called when they are needed\nvar pseudos = {\n\troot: function(elem){\n\t\treturn !getParent(elem);\n\t},\n\tempty: function(elem){\n\t\treturn !getChildren(elem).some(function(elem){\n\t\t\treturn isTag(elem) || elem.type === \"text\";\n\t\t});\n\t},\n\n\t\"first-child\": function(elem){\n\t\treturn getFirstElement(getSiblings(elem)) === elem;\n\t},\n\t\"last-child\": function(elem){\n\t\tvar siblings = getSiblings(elem);\n\n\t\tfor(var i = siblings.length - 1; i >= 0; i--){\n\t\t\tif(siblings[i] === elem) return true;\n\t\t\tif(isTag(siblings[i])) break;\n\t\t}\n\n\t\treturn false;\n\t},\n\t\"first-of-type\": function(elem){\n\t\tvar siblings = getSiblings(elem);\n\n\t\tfor(var i = 0; i < siblings.length; i++){\n\t\t\tif(isTag(siblings[i])){\n\t\t\t\tif(siblings[i] === elem) return true;\n\t\t\t\tif(getName(siblings[i]) === getName(elem)) break;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\t\"last-of-type\": function(elem){\n\t\tvar siblings = getSiblings(elem);\n\n\t\tfor(var i = siblings.length-1; i >= 0; i--){\n\t\t\tif(isTag(siblings[i])){\n\t\t\t\tif(siblings[i] === elem) return true;\n\t\t\t\tif(getName(siblings[i]) === getName(elem)) break;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t},\n\t\"only-of-type\": function(elem){\n\t\tvar siblings = getSiblings(elem);\n\n\t\tfor(var i = 0, j = siblings.length; i < j; i++){\n\t\t\tif(isTag(siblings[i])){\n\t\t\t\tif(siblings[i] === elem) continue;\n\t\t\t\tif(getName(siblings[i]) === getName(elem)) return false;\n\t\t\t}\n\t\t}\n\n\t\treturn true;\n\t},\n\t\"only-child\": function(elem){\n\t\tvar siblings = getSiblings(elem);\n\n\t\tfor(var i = 0; i < siblings.length; i++){\n\t\t\tif(isTag(siblings[i]) && siblings[i] !== elem) return false;\n\t\t}\n\n\t\treturn true;\n\t},\n\n\t//forms\n\t//to consider: :target, :enabled\n\tselected: function(elem){\n\t\tif(hasAttrib(elem, \"selected\")) return true;\n\t\telse if(getName(elem) !== \"option\") return false;\n\n\t\t//the first <option> in a <select> is also selected\n\t\tvar parent = getParent(elem);\n\n\t\tif(\n\t\t\t!parent ||\n\t\t\tgetName(parent) !== \"select\" ||\n\t\t\thasAttrib(parent, \"multiple\")\n\t\t) return false;\n\n\t\tvar siblings = getChildren(parent),\n\t\t\tsawElem  = false;\n\n\t\tfor(var i = 0; i < siblings.length; i++){\n\t\t\tif(isTag(siblings[i])){\n\t\t\t\tif(siblings[i] === elem){\n\t\t\t\t\tsawElem = true;\n\t\t\t\t} else if(!sawElem){\n\t\t\t\t\treturn false;\n\t\t\t\t} else if(hasAttrib(siblings[i], \"selected\")){\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn sawElem;\n\t},\n\tdisabled: function(elem){\n\t\treturn hasAttrib(elem, \"disabled\");\n\t},\n\tenabled: function(elem){\n\t\treturn !hasAttrib(elem, \"disabled\");\n\t},\n\tchecked: function(elem){\n\t\treturn hasAttrib(elem, \"checked\") || pseudos.selected(elem);\n\t},\n\n\t//jQuery extensions\n\n\t//:parent is the inverse of :empty\n\tparent: function(elem){\n\t\treturn !pseudos.empty(elem);\n\t},\n\theader: function(elem){\n\t\tvar name = getName(elem);\n\t\treturn name === \"h1\" ||\n\t\t       name === \"h2\" ||\n\t\t       name === \"h3\" ||\n\t\t       name === \"h4\" ||\n\t\t       name === \"h5\" ||\n\t\t       name === \"h6\";\n\t},\n\n\tbutton: function(elem){\n\t\tvar name = getName(elem);\n\t\treturn name === \"button\" ||\n\t\t       name === \"input\" &&\n\t\t       getAttribute(elem, \"type\") === \"button\";\n\t},\n\tinput: function(elem){\n\t\tvar name = getName(elem);\n\t\treturn name === \"input\" ||\n\t\t       name === \"textarea\" ||\n\t\t       name === \"select\" ||\n\t\t       name === \"button\";\n\t},\n\ttext: function(elem){\n\t\tvar attr;\n\t\treturn getName(elem) === \"input\" && (\n\t\t\t!(attr = getAttribute(elem, \"type\")) ||\n\t\t\tattr.toLowerCase() === \"text\"\n\t\t);\n\t}\n};\n\nfunction verifyArgs(func, name, subselect){\n\tif(subselect === null){\n\t\tif(func.length > 1){\n\t\t\tthrow new SyntaxError(\"pseudo-selector :\" + name + \" requires an argument\");\n\t\t}\n\t} else {\n\t\tif(func.length === 1){\n\t\t\tthrow new SyntaxError(\"pseudo-selector :\" + name + \" doesn't have any arguments\");\n\t\t}\n\t}\n}\n\n//TODO this feels hacky\nvar re_CSS3 = /^(?:(?:nth|last|first|only)-(?:child|of-type)|root|empty|(?:en|dis)abled|checked|not)$/;\n\nmodule.exports = {\n\tcompile: function(next, data, options){\n\t\tvar name = data.name,\n\t\t\tsubselect = data.data;\n\n\t\tif(options && options.strict && !re_CSS3.test(name)){\n\t\t\tthrow SyntaxError(\":\" + name + \" isn't part of CSS3\");\n\t\t}\n\n\t\tif(typeof filters[name] === \"function\"){\n\t\t\tverifyArgs(filters[name], name,  subselect);\n\t\t\treturn filters[name](next, subselect, options);\n\t\t} else if(typeof pseudos[name] === \"function\"){\n\t\t\tvar func = pseudos[name];\n\t\t\tverifyArgs(func, name, subselect);\n\n\t\t\tif(next === trueFunc) return func;\n\n\t\t\treturn function pseudoArgs(elem){\n\t\t\t\treturn func(elem, subselect) && next(elem);\n\t\t\t};\n\t\t} else {\n\t\t\tthrow new SyntaxError(\"unmatched pseudo-class :\" + name);\n\t\t}\n\t},\n\tfilters: filters,\n\tpseudos: pseudos\n};\n"]},"metadata":{},"sourceType":"script"}